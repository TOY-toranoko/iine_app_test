<h1>いいねサンプル</h1>
<% if user_signed_in? %>
  <%= link_to "ログアウト", destroy_user_session_path, :method => :delete %>
  <%= link_to "マイページへ", user_path(current_user.id) %>
  <h2>投稿する</h2>
  
  <%= form_with model:@post do |f| %>
    <%= f.label :title%>
    <%= f.text_field :title %>
    <br>
    <%= f.label :body%>
    <%= f.text_field :body %>
    <br>
    <%# <button>Submit</button> %>
    <%= f.submit %>
  <% end %>

  <hr>
  <h2>投稿一覧</h2>
  <% @posts.each do |post| %>
    <a href="/users/<%= post.user.id %>"><%= post.user.email %></a>
    <a href="/posts/<%= post.id %>"><%= post.title %></a>
    <br>
    <a href="/posts/<%= post.id %>"><%= post.body %></a>
    <br>
    (<%= post.liked_users.count %>)
    <%# 以下を追記 %>
    <% if current_user.already_liked?(post) %>
      <td><%= link_to 'いいねを外す', like_path(post.likes.find_by(user_id: current_user.id)), method: :DELETE %></td>
    <% else %>
      <td><%= link_to 'いいね', post_likes_path(post), method: :POST %></td>
    <% end %>
    <%= @path %>
    <br>
    <br>
  <% end %>
<% end %>
  <%= link_to "ユーザー登録", new_user_registration_path %>
  <%= link_to "ログイン", new_user_session_path %>


